<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Franz X. Mohr" />

<meta name="date" content="2020-09-17" />

<title>Stochastic Search Variable Selection</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Stochastic Search Variable Selection</h1>
<h4 class="author">Franz X. Mohr</h4>
<h4 class="date">2020-09-17</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>A general drawback of vector autoregressive (VAR) models is that the number of estimated coefficients increases disproportionately with the number of lags. Therefore, fewer information per parameter is available for the estimation as the number of lags increases. In the Bayesian VAR literature one approach to mitigate this so-called <em>curse of dimensionality</em> is <em>stochastic search variable selection</em> (SSVS) as proposed by George et al. (2008). The basic idea of SSVS is to assign commonly used prior variances to parameters, which should be included in a model, and prior variances close to zero to irrelevant parameters. By that, relevant parameters are estimated in the usual way and posterior draws of irrelevant variables are close to zero so that they have no significant effect on forecasts and impulse responses. This is achieved by adding a hierarchial prior to the model, where the relevance of a variable is assessed in each step of the sampling algorithm.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Korobilis (2013) proposes a similar appraoch to variable selection, which can also be applied to timy varying parameter models. The approach is implemented in <code>bvartools</code> as function <code>bvs</code>, which can be easily added to a standard Gibbs sampling algorithm. It is also implemented in the posterior simulation algorithm of the package an can be specified analogously to the last section of this introduction, where the use of the built-in SSVS sampler is described.</p>
<p>This vignette presents code for Bayesian inference of a vector autoregressive (BVAR) model using stochastic search variable selection. It uses <a href="http://www.jmulti.de/download/datasets/e1.dat">dataset E1</a> from Lütkepohl (2006), which contains data on West German fixed investment, disposable income and consumption expenditures in billions of DM from 1960Q1 to 1982Q4. Following a related example in Lütkepohl (2006, Section 5.2.10) only the first 71 observations of a VAR(4) model are used. The <code>bvartools</code> package can be used to load the data and generate the data matrices for the model.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(bvartools)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># Load and transform data</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">data</span>(<span class="st">&quot;e1&quot;</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">e1 &lt;-<span class="st"> </span><span class="kw">diff</span>(<span class="kw">log</span>(e1))</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># Shorten time series</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">e1 &lt;-<span class="st"> </span><span class="kw">window</span>(e1, <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">1978</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co"># Generate VAR</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">data &lt;-<span class="st"> </span><span class="kw">gen_var</span>(e1, <span class="dt">p =</span> <span class="dv">4</span>, <span class="dt">deterministic =</span> <span class="st">&quot;const&quot;</span>,</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">                <span class="dt">iterations =</span> <span class="dv">10000</span>, <span class="dt">burnin =</span> <span class="dv">5000</span>)</a></code></pre></div>
<p><code>bvartools</code> allows to estimate BVAR models with SSVS either by using algorithms that were written by the researchers themselves or by using the built-in posterior simulation algorithm. The first approach is presented in the following section. The latter approach is illustrated at the end of this introduction.</p>
</div>
<div id="inference-based-on-a-user-written-algorithm" class="section level2">
<h2>Inference based on a user-written algorithm</h2>
<p>The prior variances of the parameters are set in accordance with the semiautomatic approach described in George et al. (2008). Hence, the prior variance of the <span class="math inline">\(i\)</span>th parameter is set to <span class="math inline">\(\tau_{1,i}^2 = (10 \hat{\sigma}_i)^2\)</span> if this parameter should be included in the model and to <span class="math inline">\(\tau_{0,i}^2 = (0.1 \hat{\sigma}_i)^2\)</span> if it should be excluded. <span class="math inline">\(\hat{\sigma}_i\)</span> is the standard error associated with the unconstrained least squares estimate of parameter <span class="math inline">\(i\)</span>. For all variables the prior inclusion probabilities are set to 0.5. The necessary calculations can be done with function <code>ssvs_prior</code>. The prior of the error variance-covariance matrix is uninformative and, in constrast to George et al. (2008), SSVS is not applied to the covariances.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Reset random number generator for reproducibility</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">1234567</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># Get data matrices</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">y &lt;-<span class="st"> </span><span class="kw">t</span>(data<span class="op">$</span>data<span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">x &lt;-<span class="st"> </span><span class="kw">t</span>(data<span class="op">$</span>data<span class="op">$</span>Z)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">tt &lt;-<span class="st"> </span><span class="kw">ncol</span>(y) <span class="co"># Number of observations</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">k &lt;-<span class="st"> </span><span class="kw">nrow</span>(y) <span class="co"># Number of endogenous variables</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">m &lt;-<span class="st"> </span>k <span class="op">*</span><span class="st"> </span><span class="kw">nrow</span>(x) <span class="co"># Number of estimated coefficients</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co"># Coefficient priors</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">a_mu_prior &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, m) <span class="co"># Vector of prior means</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co"># SSVS priors (semiautomatic approach)</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16">vs_prior &lt;-<span class="st"> </span><span class="kw">ssvs_prior</span>(data, <span class="dt">semiautomatic =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">tau0 &lt;-<span class="st"> </span>vs_prior<span class="op">$</span>tau0</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">tau1 &lt;-<span class="st"> </span>vs_prior<span class="op">$</span>tau1</a>
<a class="sourceLine" id="cb2-19" data-line-number="19"></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co"># Prior for inclusion parameter</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21">prob_prior &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="fl">0.5</span>, m)</a>
<a class="sourceLine" id="cb2-22" data-line-number="22"></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co"># Prior for variance-covariance matrix</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24">u_sigma_df_prior &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># Prior degrees of freedom</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25">u_sigma_scale_prior &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="fl">0.00001</span>, k) <span class="co"># Prior covariance matrix</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26">u_sigma_df_post &lt;-<span class="st"> </span>tt <span class="op">+</span><span class="st"> </span>u_sigma_df_prior <span class="co"># Posterior degrees of freedom</span></a></code></pre></div>
<p>The initial parameter values are set to zero and their corresponding prior variances are set to <span class="math inline">\(\tau_1^2\)</span>, which implies that all parameters should be estimated relatively freely in the first step of the Gibbs sampler.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Initial values</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, m)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">a_v_i_prior &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">c</span>(tau1)<span class="op">^</span><span class="dv">2</span>, m) <span class="co"># Inverse of the prior covariance matrix</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># Data containers for posterior draws</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">iterations &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co"># Number of total Gibs sampler draws</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">burnin &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co"># Number of burn-in draws</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">draws &lt;-<span class="st"> </span>iterations <span class="op">+</span><span class="st"> </span>burnin <span class="co"># Total number of draws</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">draws_a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, m, iterations)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">draws_lambda &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, m, iterations)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">draws_sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, k<span class="op">^</span><span class="dv">2</span>, iterations)</a></code></pre></div>
<p>SSVS can be added to a standard Gibbs sampler algorithm for VAR models in a straightforward manner. The <code>ssvs</code> function can be used to obtain a draw of inclusion parameters and its corresponding inverted prior variance matrix. It requires the current draw of parameters, standard errors <span class="math inline">\(\tau_0\)</span> and <span class="math inline">\(\tau_1\)</span>, and prior inclusion probabilities as arguments. In this example constant terms are excluded from SSVS, which is achieved by specifying <code>include = 1:36</code>. Hence, only parameters 1 to 36 are considered by the function and the remaining three parameters have prior variances that correspond to their values in <span class="math inline">\(\tau_1^2\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Start Gibbs sampler</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="cf">for</span> (draw <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>draws) {</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="co"># Draw variance-covariance matrix</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  u &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">matrix</span>(a, k) <span class="op">%*%</span><span class="st"> </span>x <span class="co"># Obtain residuals</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="co"># Scale posterior</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  u_sigma_scale_post &lt;-<span class="st"> </span><span class="kw">solve</span>(u_sigma_scale_prior <span class="op">+</span><span class="st"> </span><span class="kw">tcrossprod</span>(u))</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  <span class="co"># Draw posterior of inverse sigma</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">  u_sigma_i &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rWishart</span>(<span class="dv">1</span>, u_sigma_df_post, u_sigma_scale_post)[,, <span class="dv">1</span>], k)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  <span class="co"># Obtain sigma</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">  u_sigma &lt;-<span class="st"> </span><span class="kw">solve</span>(u_sigma_i)</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  <span class="co"># Draw conditional mean parameters</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  a &lt;-<span class="st"> </span><span class="kw">post_normal</span>(y, x, u_sigma_i, a_mu_prior, a_v_i_prior)</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  <span class="co"># Draw inclusion parameters and update priors</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16">  temp &lt;-<span class="st"> </span><span class="kw">ssvs</span>(a, tau0, tau1, prob_prior, <span class="dt">include =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">36</span>)</a>
<a class="sourceLine" id="cb4-17" data-line-number="17">  a_v_i_prior &lt;-<span class="st"> </span>temp<span class="op">$</span>v_i <span class="co"># Update prior</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18">  </a>
<a class="sourceLine" id="cb4-19" data-line-number="19">  <span class="co"># Store draws</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20">  <span class="cf">if</span> (draw <span class="op">&gt;</span><span class="st"> </span>burnin) {</a>
<a class="sourceLine" id="cb4-21" data-line-number="21">    draws_a[, draw <span class="op">-</span><span class="st"> </span>burnin] &lt;-<span class="st"> </span>a</a>
<a class="sourceLine" id="cb4-22" data-line-number="22">    draws_lambda[, draw <span class="op">-</span><span class="st"> </span>burnin] &lt;-<span class="st"> </span>temp<span class="op">$</span>lambda</a>
<a class="sourceLine" id="cb4-23" data-line-number="23">    draws_sigma[, draw <span class="op">-</span><span class="st"> </span>burnin] &lt;-<span class="st"> </span>u_sigma</a>
<a class="sourceLine" id="cb4-24" data-line-number="24">  }</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">}</a></code></pre></div>
<p>The output of a Gibbs sampler with SSVS can be further analysed in the usual way. With the <code>bvartools</code> package the posterior draws can be collected in a <code>bvar</code> object and the <code>summary</code> method provides summary statistics. It is also possible to add information on the inclusion parameters to the <code>bvar</code> object by providing a named list as an argument. The list must contain an element <code>coeffs</code>, which contains the MCMC draws of the coefficients, and element <code>lambda</code> contains the corresponding draw of the inclusion parameter.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">bvar_est &lt;-<span class="st"> </span><span class="kw">bvar</span>(<span class="dt">y =</span> data<span class="op">$</span>data<span class="op">$</span>Y, <span class="dt">x =</span> data<span class="op">$</span>data<span class="op">$</span>Z,</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                 <span class="dt">A =</span> <span class="kw">list</span>(<span class="dt">coeffs =</span> draws_a[<span class="dv">1</span><span class="op">:</span><span class="dv">36</span>,],</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                          <span class="dt">lambda =</span> draws_lambda[<span class="dv">1</span><span class="op">:</span><span class="dv">36</span>,]),</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                 <span class="dt">C =</span> <span class="kw">list</span>(<span class="dt">coeffs =</span> draws_a[<span class="dv">37</span><span class="op">:</span><span class="dv">39</span>, ],</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">                          <span class="dt">lambda =</span> draws_lambda[<span class="dv">37</span><span class="op">:</span><span class="dv">39</span>,]),</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">                 <span class="dt">Sigma =</span> draws_sigma)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">bvar_summary &lt;-<span class="st"> </span><span class="kw">summary</span>(bvar_est)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">bvar_summary</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; Model:</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; y ~ invest.1 + income.1 + cons.1 + invest.2 + income.2 + cons.2 + invest.3 + income.3 + cons.3 + invest.4 + income.4 + cons.4 + const</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; Variable: invest </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt;               Mean      SD  Naive SD Time-series SD      2.5%       50%   97.5%</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; invest.1 -0.102678 0.13826 0.0013826      0.0067122 -0.411837 -0.016493 0.02130</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; income.1  0.030302 0.17083 0.0017083      0.0034326 -0.124401  0.008322 0.57057</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; cons.1    0.095132 0.32165 0.0032165      0.0100857 -0.156626  0.019395 1.20857</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; invest.2 -0.012007 0.05070 0.0005070      0.0012843 -0.187390 -0.002507 0.03014</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt; income.2  0.006950 0.14724 0.0014724      0.0017426 -0.156169  0.002443 0.27650</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; cons.2    0.021886 0.17860 0.0017860      0.0032578 -0.182990  0.007841 0.40729</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt; invest.3  0.032122 0.07987 0.0007987      0.0025971 -0.026218  0.005942 0.28849</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt; income.3 -0.007616 0.15335 0.0015335      0.0020519 -0.296980 -0.001926 0.19233</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt; cons.3   -0.047414 0.21576 0.0021576      0.0044539 -0.724049 -0.013501 0.15528</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">#&gt; invest.4  0.264164 0.15632 0.0015632      0.0098066 -0.009652  0.290565 0.53103</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">#&gt; income.4 -0.055766 0.21719 0.0021719      0.0049718 -0.802918 -0.014542 0.12295</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="co">#&gt; cons.4   -0.021885 0.18660 0.0018660      0.0031490 -0.515568 -0.006293 0.16283</span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="co">#&gt; const     0.013325 0.01208 0.0001208      0.0002352 -0.012475  0.013477 0.03766</span></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"><span class="co">#&gt;          Incl. prob.</span></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="co">#&gt; invest.1      0.4262</span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="co">#&gt; income.1      0.0797</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="co">#&gt; cons.1        0.1305</span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36"><span class="co">#&gt; invest.2      0.1068</span></a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="co">#&gt; income.2      0.0701</span></a>
<a class="sourceLine" id="cb5-38" data-line-number="38"><span class="co">#&gt; cons.2        0.0623</span></a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="co">#&gt; invest.3      0.1870</span></a>
<a class="sourceLine" id="cb5-40" data-line-number="40"><span class="co">#&gt; income.3      0.0763</span></a>
<a class="sourceLine" id="cb5-41" data-line-number="41"><span class="co">#&gt; cons.3        0.0911</span></a>
<a class="sourceLine" id="cb5-42" data-line-number="42"><span class="co">#&gt; invest.4      0.8281</span></a>
<a class="sourceLine" id="cb5-43" data-line-number="43"><span class="co">#&gt; income.4      0.1135</span></a>
<a class="sourceLine" id="cb5-44" data-line-number="44"><span class="co">#&gt; cons.4        0.0797</span></a>
<a class="sourceLine" id="cb5-45" data-line-number="45"><span class="co">#&gt; const         1.0000</span></a>
<a class="sourceLine" id="cb5-46" data-line-number="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-47" data-line-number="47"><span class="co">#&gt; Variable: income </span></a>
<a class="sourceLine" id="cb5-48" data-line-number="48"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-49" data-line-number="49"><span class="co">#&gt;                Mean       SD  Naive SD Time-series SD      2.5%        50%</span></a>
<a class="sourceLine" id="cb5-50" data-line-number="50"><span class="co">#&gt; invest.1  9.956e-03 0.021913 2.191e-04      7.948e-04 -0.006260  1.827e-03</span></a>
<a class="sourceLine" id="cb5-51" data-line-number="51"><span class="co">#&gt; income.1 -2.366e-02 0.085353 8.535e-04      4.298e-03 -0.313599 -3.453e-03</span></a>
<a class="sourceLine" id="cb5-52" data-line-number="52"><span class="co">#&gt; cons.1    1.308e-01 0.190136 1.901e-03      1.324e-02 -0.033440  2.252e-02</span></a>
<a class="sourceLine" id="cb5-53" data-line-number="53"><span class="co">#&gt; invest.2  1.851e-03 0.011114 1.111e-04      2.645e-04 -0.008256  4.361e-04</span></a>
<a class="sourceLine" id="cb5-54" data-line-number="54"><span class="co">#&gt; income.2  4.504e-03 0.041084 4.108e-04      6.930e-04 -0.037925  1.644e-03</span></a>
<a class="sourceLine" id="cb5-55" data-line-number="55"><span class="co">#&gt; cons.2   -6.459e-04 0.037967 3.797e-04      4.375e-04 -0.054470 -4.947e-04</span></a>
<a class="sourceLine" id="cb5-56" data-line-number="56"><span class="co">#&gt; invest.3 -6.077e-05 0.008284 8.284e-05      9.137e-05 -0.012292 -3.118e-05</span></a>
<a class="sourceLine" id="cb5-57" data-line-number="57"><span class="co">#&gt; income.3  1.780e-02 0.060741 6.074e-04      2.057e-03 -0.031838  4.959e-03</span></a>
<a class="sourceLine" id="cb5-58" data-line-number="58"><span class="co">#&gt; cons.3    6.922e-03 0.049219 4.922e-04      9.647e-04 -0.047575  2.479e-03</span></a>
<a class="sourceLine" id="cb5-59" data-line-number="59"><span class="co">#&gt; invest.4  1.925e-03 0.010591 1.059e-04      2.051e-04 -0.008012  4.585e-04</span></a>
<a class="sourceLine" id="cb5-60" data-line-number="60"><span class="co">#&gt; income.4 -1.114e-02 0.045967 4.597e-04      1.077e-03 -0.165655 -3.475e-03</span></a>
<a class="sourceLine" id="cb5-61" data-line-number="61"><span class="co">#&gt; cons.4    1.297e-03 0.034280 3.428e-04      3.310e-04 -0.043869  7.042e-04</span></a>
<a class="sourceLine" id="cb5-62" data-line-number="62"><span class="co">#&gt; const     1.742e-02 0.003922 3.922e-05      1.701e-04  0.008960  1.802e-02</span></a>
<a class="sourceLine" id="cb5-63" data-line-number="63"><span class="co">#&gt;            97.5% Incl. prob.</span></a>
<a class="sourceLine" id="cb5-64" data-line-number="64"><span class="co">#&gt; invest.1 0.07729      0.2167</span></a>
<a class="sourceLine" id="cb5-65" data-line-number="65"><span class="co">#&gt; income.1 0.03551      0.1404</span></a>
<a class="sourceLine" id="cb5-66" data-line-number="66"><span class="co">#&gt; cons.1   0.58572      0.3881</span></a>
<a class="sourceLine" id="cb5-67" data-line-number="67"><span class="co">#&gt; invest.2 0.03535      0.0842</span></a>
<a class="sourceLine" id="cb5-68" data-line-number="68"><span class="co">#&gt; income.2 0.09878      0.0715</span></a>
<a class="sourceLine" id="cb5-69" data-line-number="69"><span class="co">#&gt; cons.2   0.05278      0.0506</span></a>
<a class="sourceLine" id="cb5-70" data-line-number="70"><span class="co">#&gt; invest.3 0.01080      0.0706</span></a>
<a class="sourceLine" id="cb5-71" data-line-number="71"><span class="co">#&gt; income.3 0.23046      0.1069</span></a>
<a class="sourceLine" id="cb5-72" data-line-number="72"><span class="co">#&gt; cons.3   0.13588      0.0752</span></a>
<a class="sourceLine" id="cb5-73" data-line-number="73"><span class="co">#&gt; invest.4 0.03454      0.0965</span></a>
<a class="sourceLine" id="cb5-74" data-line-number="74"><span class="co">#&gt; income.4 0.03167      0.0934</span></a>
<a class="sourceLine" id="cb5-75" data-line-number="75"><span class="co">#&gt; cons.4   0.04732      0.0553</span></a>
<a class="sourceLine" id="cb5-76" data-line-number="76"><span class="co">#&gt; const    0.02394      1.0000</span></a>
<a class="sourceLine" id="cb5-77" data-line-number="77"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-78" data-line-number="78"><span class="co">#&gt; Variable: cons </span></a>
<a class="sourceLine" id="cb5-79" data-line-number="79"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-80" data-line-number="80"><span class="co">#&gt;                Mean       SD  Naive SD Time-series SD      2.5%        50%</span></a>
<a class="sourceLine" id="cb5-81" data-line-number="81"><span class="co">#&gt; invest.1 -0.0019158 0.009862 9.862e-05      2.629e-04 -0.033258 -4.062e-04</span></a>
<a class="sourceLine" id="cb5-82" data-line-number="82"><span class="co">#&gt; income.1  0.1557165 0.140919 1.409e-03      1.107e-02 -0.015750  1.699e-01</span></a>
<a class="sourceLine" id="cb5-83" data-line-number="83"><span class="co">#&gt; cons.1   -0.2704923 0.197753 1.978e-03      1.768e-02 -0.596806 -3.102e-01</span></a>
<a class="sourceLine" id="cb5-84" data-line-number="84"><span class="co">#&gt; invest.2  0.0055334 0.015130 1.513e-04      5.850e-04 -0.005640  1.104e-03</span></a>
<a class="sourceLine" id="cb5-85" data-line-number="85"><span class="co">#&gt; income.2  0.3056906 0.100301 1.003e-03      4.675e-03  0.013740  3.133e-01</span></a>
<a class="sourceLine" id="cb5-86" data-line-number="86"><span class="co">#&gt; cons.2    0.0098651 0.055799 5.580e-04      3.613e-03 -0.040072  2.129e-03</span></a>
<a class="sourceLine" id="cb5-87" data-line-number="87"><span class="co">#&gt; invest.3  0.0003352 0.006858 6.858e-05      8.552e-05 -0.007689  6.655e-05</span></a>
<a class="sourceLine" id="cb5-88" data-line-number="88"><span class="co">#&gt; income.3  0.0106024 0.043671 4.367e-04      1.472e-03 -0.026945  2.755e-03</span></a>
<a class="sourceLine" id="cb5-89" data-line-number="89"><span class="co">#&gt; cons.3    0.0211561 0.062100 6.210e-04      1.952e-03 -0.029379  5.506e-03</span></a>
<a class="sourceLine" id="cb5-90" data-line-number="90"><span class="co">#&gt; invest.4 -0.0040890 0.012678 1.268e-04      3.930e-04 -0.048091 -8.160e-04</span></a>
<a class="sourceLine" id="cb5-91" data-line-number="91"><span class="co">#&gt; income.4  0.0258709 0.061971 6.197e-04      2.026e-03 -0.022137  5.951e-03</span></a>
<a class="sourceLine" id="cb5-92" data-line-number="92"><span class="co">#&gt; cons.4   -0.0001850 0.030872 3.087e-04      4.057e-04 -0.046276  3.982e-05</span></a>
<a class="sourceLine" id="cb5-93" data-line-number="93"><span class="co">#&gt; const     0.0140811 0.003528 3.528e-05      1.058e-04  0.007062  1.407e-02</span></a>
<a class="sourceLine" id="cb5-94" data-line-number="94"><span class="co">#&gt;             97.5% Incl. prob.</span></a>
<a class="sourceLine" id="cb5-95" data-line-number="95"><span class="co">#&gt; invest.1 0.006557      0.1047</span></a>
<a class="sourceLine" id="cb5-96" data-line-number="96"><span class="co">#&gt; income.1 0.408675      0.6205</span></a>
<a class="sourceLine" id="cb5-97" data-line-number="97"><span class="co">#&gt; cons.1   0.018590      0.7312</span></a>
<a class="sourceLine" id="cb5-98" data-line-number="98"><span class="co">#&gt; invest.2 0.055340      0.1609</span></a>
<a class="sourceLine" id="cb5-99" data-line-number="99"><span class="co">#&gt; income.2 0.482837      0.9685</span></a>
<a class="sourceLine" id="cb5-100" data-line-number="100"><span class="co">#&gt; cons.2   0.187899      0.0879</span></a>
<a class="sourceLine" id="cb5-101" data-line-number="101"><span class="co">#&gt; invest.3 0.012455      0.0711</span></a>
<a class="sourceLine" id="cb5-102" data-line-number="102"><span class="co">#&gt; income.3 0.159233      0.1018</span></a>
<a class="sourceLine" id="cb5-103" data-line-number="103"><span class="co">#&gt; cons.3   0.230200      0.1362</span></a>
<a class="sourceLine" id="cb5-104" data-line-number="104"><span class="co">#&gt; invest.4 0.005295      0.1339</span></a>
<a class="sourceLine" id="cb5-105" data-line-number="105"><span class="co">#&gt; income.4 0.222811      0.1825</span></a>
<a class="sourceLine" id="cb5-106" data-line-number="106"><span class="co">#&gt; cons.4   0.040838      0.0689</span></a>
<a class="sourceLine" id="cb5-107" data-line-number="107"><span class="co">#&gt; const    0.021018      1.0000</span></a>
<a class="sourceLine" id="cb5-108" data-line-number="108"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-109" data-line-number="109"><span class="co">#&gt; Variance-covariance matrix:</span></a>
<a class="sourceLine" id="cb5-110" data-line-number="110"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-111" data-line-number="111"><span class="co">#&gt;                    Mean        SD  Naive SD Time-series SD       2.5%       50%</span></a>
<a class="sourceLine" id="cb5-112" data-line-number="112"><span class="co">#&gt; invest_invest 2.185e-03 3.999e-04 3.999e-06      6.265e-06  1.532e-03 2.142e-03</span></a>
<a class="sourceLine" id="cb5-113" data-line-number="113"><span class="co">#&gt; invest_income 4.850e-05 7.491e-05 7.491e-07      9.895e-07 -9.693e-05 4.608e-05</span></a>
<a class="sourceLine" id="cb5-114" data-line-number="114"><span class="co">#&gt; invest_cons   1.402e-04 6.155e-05 6.155e-07      7.129e-07  2.726e-05 1.363e-04</span></a>
<a class="sourceLine" id="cb5-115" data-line-number="115"><span class="co">#&gt; income_invest 4.850e-05 7.491e-05 7.491e-07      9.895e-07 -9.693e-05 4.608e-05</span></a>
<a class="sourceLine" id="cb5-116" data-line-number="116"><span class="co">#&gt; income_income 1.513e-04 2.695e-05 2.695e-07      2.843e-07  1.068e-04 1.484e-04</span></a>
<a class="sourceLine" id="cb5-117" data-line-number="117"><span class="co">#&gt; income_cons   6.660e-05 1.781e-05 1.781e-07      2.403e-07  3.610e-05 6.500e-05</span></a>
<a class="sourceLine" id="cb5-118" data-line-number="118"><span class="co">#&gt; cons_invest   1.402e-04 6.155e-05 6.155e-07      7.129e-07  2.726e-05 1.363e-04</span></a>
<a class="sourceLine" id="cb5-119" data-line-number="119"><span class="co">#&gt; cons_income   6.660e-05 1.781e-05 1.781e-07      2.403e-07  3.610e-05 6.500e-05</span></a>
<a class="sourceLine" id="cb5-120" data-line-number="120"><span class="co">#&gt; cons_cons     9.778e-05 1.799e-05 1.799e-07      3.400e-07  6.843e-05 9.601e-05</span></a>
<a class="sourceLine" id="cb5-121" data-line-number="121"><span class="co">#&gt;                   97.5%</span></a>
<a class="sourceLine" id="cb5-122" data-line-number="122"><span class="co">#&gt; invest_invest 0.0030856</span></a>
<a class="sourceLine" id="cb5-123" data-line-number="123"><span class="co">#&gt; invest_income 0.0002018</span></a>
<a class="sourceLine" id="cb5-124" data-line-number="124"><span class="co">#&gt; invest_cons   0.0002725</span></a>
<a class="sourceLine" id="cb5-125" data-line-number="125"><span class="co">#&gt; income_invest 0.0002018</span></a>
<a class="sourceLine" id="cb5-126" data-line-number="126"><span class="co">#&gt; income_income 0.0002132</span></a>
<a class="sourceLine" id="cb5-127" data-line-number="127"><span class="co">#&gt; income_cons   0.0001062</span></a>
<a class="sourceLine" id="cb5-128" data-line-number="128"><span class="co">#&gt; cons_invest   0.0002725</span></a>
<a class="sourceLine" id="cb5-129" data-line-number="129"><span class="co">#&gt; cons_income   0.0001062</span></a>
<a class="sourceLine" id="cb5-130" data-line-number="130"><span class="co">#&gt; cons_cons     0.0001381</span></a></code></pre></div>
<p>The inclusion probabilities of the constant terms are 100 percent, because they were excluded from SSVS.</p>
<p>Using the results from above the researcher could proceed in the usual way and obtain forecasts and impulse responses based on the output of the Gibbs sampler. The advantage of this approach is that it does not only take into account parameter uncertainty, but also model uncertainty. This can be illustrated by the histogram of the posterior draws of the 6th coefficient, which describes the relationship between the first lag of income and the current value of consumption.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">hist</span>(draws_a[<span class="dv">6</span>,], <span class="dt">main =</span> <span class="st">&quot;Consumption ~ First lag of income&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Value of posterior draw&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A non-negligible mass of some 23 percent, i.e. 1 - 0.67, of the parameter draws is concentrated around zero. This is the result of SSVS, where posterior draws are close to zero if a constant is assessed to be irrelevant during an iteration of the Gibbs sampler and, therefore, <span class="math inline">\(\tau_{0,6}^2\)</span> is used as its prior variance. On the other hand, about 67 percent of the draws are dispersed around a positive value, where SSVS suggests to include the variable in the model and the larger value <span class="math inline">\(\tau_{1,6}^2\)</span> is used as prior variance. Model uncertainty is then described by the two peaks and parameter uncertainty by the dispersion of the posterior draws around them.</p>
<p>However, if the researcher prefers not to work with a model, where the relevance of a variable can change from one step of the sampling algorithm to the next, a different approach would be to work only with a highly probable model. This can be done with a further simulation, where very tight priors are used for irrelevant variables and relatively uninformative priors for relevant parameters. In this example, coefficients with a posterior inclusion probability of above 40 percent are considered to be relevant.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> The prior variance is set to 0.00001 for irrelevant and to 9 for relevant variables. No additional SSVS step is required. Everything else remains unchanged.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Get inclusion probabilities</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">lambda &lt;-<span class="st"> </span>bvar_summary<span class="op">$</span>coefficients<span class="op">$</span>lambda</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># Select variables that should be included</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">include_var &lt;-<span class="st"> </span><span class="kw">c</span>(lambda <span class="op">&gt;=</span><span class="st"> </span><span class="fl">.4</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co"># Update prior variances</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw">diag</span>(a_v_i_prior)[<span class="op">!</span>include_var] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="fl">0.00001</span> <span class="co"># Very tight prior close to zero</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="kw">diag</span>(a_v_i_prior)[include_var] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">9</span> <span class="co"># Relatively uninformative prior</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co"># Data containers for posterior draws</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">draws_a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, m, iterations)</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">draws_sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, k<span class="op">^</span><span class="dv">2</span>, iterations)</a>
<a class="sourceLine" id="cb7-14" data-line-number="14"></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co"># Start Gibbs sampler</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="cf">for</span> (draw <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>draws) {</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">  <span class="co"># Draw conditional mean parameters</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18">  a &lt;-<span class="st"> </span><span class="kw">post_normal</span>(y, x, u_sigma_i, a_mu_prior, a_v_i_prior)</a>
<a class="sourceLine" id="cb7-19" data-line-number="19">  </a>
<a class="sourceLine" id="cb7-20" data-line-number="20">  <span class="co"># Draw variance-covariance matrix</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21">  u &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">matrix</span>(a, k) <span class="op">%*%</span><span class="st"> </span>x <span class="co"># Obtain residuals</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22">  u_sigma_scale_post &lt;-<span class="st"> </span><span class="kw">solve</span>(u_sigma_scale_prior <span class="op">+</span><span class="st"> </span><span class="kw">tcrossprod</span>(u))</a>
<a class="sourceLine" id="cb7-23" data-line-number="23">  u_sigma_i &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rWishart</span>(<span class="dv">1</span>, u_sigma_df_post, u_sigma_scale_post)[,, <span class="dv">1</span>], k)</a>
<a class="sourceLine" id="cb7-24" data-line-number="24">  u_sigma &lt;-<span class="st"> </span><span class="kw">solve</span>(u_sigma_i) <span class="co"># Invert Sigma_i to obtain Sigma</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25">  </a>
<a class="sourceLine" id="cb7-26" data-line-number="26">  <span class="co"># Store draws</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27">  <span class="cf">if</span> (draw <span class="op">&gt;</span><span class="st"> </span>burnin) {</a>
<a class="sourceLine" id="cb7-28" data-line-number="28">    draws_a[, draw <span class="op">-</span><span class="st"> </span>burnin] &lt;-<span class="st"> </span>a</a>
<a class="sourceLine" id="cb7-29" data-line-number="29">    draws_sigma[, draw <span class="op">-</span><span class="st"> </span>burnin] &lt;-<span class="st"> </span>u_sigma</a>
<a class="sourceLine" id="cb7-30" data-line-number="30">  }</a>
<a class="sourceLine" id="cb7-31" data-line-number="31">}</a></code></pre></div>
<p>The means of the posterior draws are similar to the OLS estimates in Lütkepohl (2006, Section 5.2.10):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">bvar_est &lt;-<span class="st"> </span><span class="kw">bvar</span>(<span class="dt">y =</span> data<span class="op">$</span>data<span class="op">$</span>Y, <span class="dt">x =</span> data<span class="op">$</span>data<span class="op">$</span>Z, <span class="dt">A =</span> draws_a[<span class="dv">1</span><span class="op">:</span><span class="dv">36</span>,],</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                 <span class="dt">C =</span> draws_a[<span class="dv">37</span><span class="op">:</span><span class="dv">39</span>, ], <span class="dt">Sigma =</span> draws_sigma)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="kw">summary</span>(bvar_est)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; Model:</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; y ~ invest.1 + income.1 + cons.1 + invest.2 + income.2 + cons.2 + invest.3 + income.3 + cons.3 + invest.4 + income.4 + cons.4 + const</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; Variable: invest </span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;                Mean       SD  Naive SD Time-series SD      2.5%        50%</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; invest.1 -2.273e-01 0.109891 1.099e-03      1.132e-03 -0.442479 -2.280e-01</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; income.1  6.902e-07 0.003206 3.206e-05      3.206e-05 -0.006286 -9.111e-06</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; cons.1   -3.872e-05 0.003141 3.141e-05      3.141e-05 -0.006291 -1.351e-05</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; invest.2 -1.476e-04 0.003188 3.188e-05      3.188e-05 -0.006379 -1.627e-04</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; income.2  1.006e-05 0.003115 3.115e-05      3.115e-05 -0.006058  6.718e-06</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; cons.2    1.298e-05 0.003183 3.183e-05      3.183e-05 -0.006185  7.462e-06</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; invest.3  9.864e-05 0.003181 3.181e-05      3.181e-05 -0.006223  5.629e-05</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; income.3 -4.254e-05 0.003156 3.156e-05      3.238e-05 -0.006291 -1.891e-05</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; cons.3    2.170e-05 0.003148 3.148e-05      3.058e-05 -0.006153  1.975e-05</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt; invest.4  3.267e-01 0.108329 1.083e-03      1.083e-03  0.113552  3.267e-01</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; income.4 -1.611e-05 0.003135 3.135e-05      3.135e-05 -0.006243  8.115e-06</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt; cons.4    4.579e-05 0.003154 3.154e-05      3.076e-05 -0.006085  7.562e-05</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt; const     1.519e-02 0.006069 6.069e-05      6.069e-05  0.003176  1.523e-02</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt;              97.5%</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; invest.1 -0.013764</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; income.1  0.006310</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; cons.1    0.006061</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; invest.2  0.006064</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; income.2  0.006000</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; cons.2    0.006263</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; invest.3  0.006299</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; income.3  0.006131</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; cons.3    0.006159</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; invest.4  0.536211</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; income.4  0.006153</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; cons.4    0.006270</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt; const     0.026959</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt; Variable: income </span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt;                Mean       SD  Naive SD Time-series SD      2.5%        50%</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt; invest.1  6.869e-04 0.003136 3.136e-05      3.193e-05 -0.005465  6.890e-04</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt; income.1  1.075e-05 0.003137 3.137e-05      3.160e-05 -0.006210  2.738e-05</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt; cons.1    1.151e-04 0.003147 3.147e-05      3.090e-05 -0.005923  1.105e-04</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co">#&gt; invest.2  6.772e-05 0.003097 3.097e-05      3.097e-05 -0.006038  1.310e-04</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#&gt; income.2  5.710e-05 0.003196 3.196e-05      3.401e-05 -0.006141  5.508e-05</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="co">#&gt; cons.2   -1.453e-05 0.003160 3.160e-05      3.160e-05 -0.006246 -2.748e-05</span></a>
<a class="sourceLine" id="cb8-50" data-line-number="50"><span class="co">#&gt; invest.3  5.477e-05 0.003141 3.141e-05      3.141e-05 -0.006140  7.633e-05</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51"><span class="co">#&gt; income.3  1.774e-04 0.003156 3.156e-05      3.156e-05 -0.006066  1.634e-04</span></a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="co">#&gt; cons.3    3.008e-05 0.003135 3.135e-05      3.135e-05 -0.006256  4.382e-05</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="co">#&gt; invest.4  2.947e-04 0.003174 3.174e-05      3.120e-05 -0.005938  3.048e-04</span></a>
<a class="sourceLine" id="cb8-54" data-line-number="54"><span class="co">#&gt; income.4 -4.550e-05 0.003163 3.163e-05      3.163e-05 -0.006330 -1.594e-05</span></a>
<a class="sourceLine" id="cb8-55" data-line-number="55"><span class="co">#&gt; cons.4   -3.258e-05 0.003163 3.163e-05      3.163e-05 -0.006236 -6.488e-05</span></a>
<a class="sourceLine" id="cb8-56" data-line-number="56"><span class="co">#&gt; const     2.014e-02 0.001479 1.479e-05      1.479e-05  0.017236  2.016e-02</span></a>
<a class="sourceLine" id="cb8-57" data-line-number="57"><span class="co">#&gt;             97.5%</span></a>
<a class="sourceLine" id="cb8-58" data-line-number="58"><span class="co">#&gt; invest.1 0.006849</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59"><span class="co">#&gt; income.1 0.006054</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60"><span class="co">#&gt; cons.1   0.006304</span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="co">#&gt; invest.2 0.006066</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="co">#&gt; income.2 0.006299</span></a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="co">#&gt; cons.2   0.006191</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64"><span class="co">#&gt; invest.3 0.006201</span></a>
<a class="sourceLine" id="cb8-65" data-line-number="65"><span class="co">#&gt; income.3 0.006285</span></a>
<a class="sourceLine" id="cb8-66" data-line-number="66"><span class="co">#&gt; cons.3   0.006174</span></a>
<a class="sourceLine" id="cb8-67" data-line-number="67"><span class="co">#&gt; invest.4 0.006435</span></a>
<a class="sourceLine" id="cb8-68" data-line-number="68"><span class="co">#&gt; income.4 0.006075</span></a>
<a class="sourceLine" id="cb8-69" data-line-number="69"><span class="co">#&gt; cons.4   0.006140</span></a>
<a class="sourceLine" id="cb8-70" data-line-number="70"><span class="co">#&gt; const    0.023037</span></a>
<a class="sourceLine" id="cb8-71" data-line-number="71"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-72" data-line-number="72"><span class="co">#&gt; Variable: cons </span></a>
<a class="sourceLine" id="cb8-73" data-line-number="73"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-74" data-line-number="74"><span class="co">#&gt;                Mean       SD  Naive SD Time-series SD      2.5%        50%</span></a>
<a class="sourceLine" id="cb8-75" data-line-number="75"><span class="co">#&gt; invest.1 -5.275e-04 0.003134 3.134e-05      3.134e-05 -0.006716 -5.338e-04</span></a>
<a class="sourceLine" id="cb8-76" data-line-number="76"><span class="co">#&gt; income.1  2.618e-01 0.085979 8.598e-04      8.924e-04  0.094695  2.612e-01</span></a>
<a class="sourceLine" id="cb8-77" data-line-number="77"><span class="co">#&gt; cons.1   -4.362e-01 0.102607 1.026e-03      1.083e-03 -0.638762 -4.368e-01</span></a>
<a class="sourceLine" id="cb8-78" data-line-number="78"><span class="co">#&gt; invest.2  6.559e-04 0.003116 3.116e-05      3.116e-05 -0.005524  6.822e-04</span></a>
<a class="sourceLine" id="cb8-79" data-line-number="79"><span class="co">#&gt; income.2  3.289e-01 0.076682 7.668e-04      7.837e-04  0.176874  3.294e-01</span></a>
<a class="sourceLine" id="cb8-80" data-line-number="80"><span class="co">#&gt; cons.2   -8.815e-06 0.003175 3.175e-05      3.175e-05 -0.006188  6.246e-06</span></a>
<a class="sourceLine" id="cb8-81" data-line-number="81"><span class="co">#&gt; invest.3  8.475e-05 0.003139 3.139e-05      3.139e-05 -0.006145  1.200e-04</span></a>
<a class="sourceLine" id="cb8-82" data-line-number="82"><span class="co">#&gt; income.3  1.198e-04 0.003193 3.193e-05      3.193e-05 -0.006138  1.262e-04</span></a>
<a class="sourceLine" id="cb8-83" data-line-number="83"><span class="co">#&gt; cons.3    1.700e-04 0.003189 3.189e-05      3.286e-05 -0.006022  1.339e-04</span></a>
<a class="sourceLine" id="cb8-84" data-line-number="84"><span class="co">#&gt; invest.4 -5.389e-04 0.003125 3.125e-05      3.125e-05 -0.006711 -4.977e-04</span></a>
<a class="sourceLine" id="cb8-85" data-line-number="85"><span class="co">#&gt; income.4  1.594e-04 0.003161 3.161e-05      3.161e-05 -0.005997  1.459e-04</span></a>
<a class="sourceLine" id="cb8-86" data-line-number="86"><span class="co">#&gt; cons.4    4.326e-05 0.003131 3.131e-05      3.131e-05 -0.006195  7.535e-05</span></a>
<a class="sourceLine" id="cb8-87" data-line-number="87"><span class="co">#&gt; const     1.611e-02 0.002675 2.675e-05      2.783e-05  0.010777  1.613e-02</span></a>
<a class="sourceLine" id="cb8-88" data-line-number="88"><span class="co">#&gt;              97.5%</span></a>
<a class="sourceLine" id="cb8-89" data-line-number="89"><span class="co">#&gt; invest.1  0.005679</span></a>
<a class="sourceLine" id="cb8-90" data-line-number="90"><span class="co">#&gt; income.1  0.431811</span></a>
<a class="sourceLine" id="cb8-91" data-line-number="91"><span class="co">#&gt; cons.1   -0.233266</span></a>
<a class="sourceLine" id="cb8-92" data-line-number="92"><span class="co">#&gt; invest.2  0.006694</span></a>
<a class="sourceLine" id="cb8-93" data-line-number="93"><span class="co">#&gt; income.2  0.479725</span></a>
<a class="sourceLine" id="cb8-94" data-line-number="94"><span class="co">#&gt; cons.2    0.006226</span></a>
<a class="sourceLine" id="cb8-95" data-line-number="95"><span class="co">#&gt; invest.3  0.006270</span></a>
<a class="sourceLine" id="cb8-96" data-line-number="96"><span class="co">#&gt; income.3  0.006302</span></a>
<a class="sourceLine" id="cb8-97" data-line-number="97"><span class="co">#&gt; cons.3    0.006470</span></a>
<a class="sourceLine" id="cb8-98" data-line-number="98"><span class="co">#&gt; invest.4  0.005557</span></a>
<a class="sourceLine" id="cb8-99" data-line-number="99"><span class="co">#&gt; income.4  0.006426</span></a>
<a class="sourceLine" id="cb8-100" data-line-number="100"><span class="co">#&gt; cons.4    0.006137</span></a>
<a class="sourceLine" id="cb8-101" data-line-number="101"><span class="co">#&gt; const     0.021319</span></a>
<a class="sourceLine" id="cb8-102" data-line-number="102"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-103" data-line-number="103"><span class="co">#&gt; Variance-covariance matrix:</span></a>
<a class="sourceLine" id="cb8-104" data-line-number="104"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-105" data-line-number="105"><span class="co">#&gt;                    Mean        SD  Naive SD Time-series SD       2.5%       50%</span></a>
<a class="sourceLine" id="cb8-106" data-line-number="106"><span class="co">#&gt; invest_invest 2.091e-03 3.726e-04 3.726e-06      3.857e-06  1.487e-03 2.051e-03</span></a>
<a class="sourceLine" id="cb8-107" data-line-number="107"><span class="co">#&gt; invest_income 6.378e-05 7.091e-05 7.091e-07      7.335e-07 -7.152e-05 6.190e-05</span></a>
<a class="sourceLine" id="cb8-108" data-line-number="108"><span class="co">#&gt; invest_cons   1.383e-04 5.890e-05 5.890e-07      6.105e-07  3.342e-05 1.342e-04</span></a>
<a class="sourceLine" id="cb8-109" data-line-number="109"><span class="co">#&gt; income_invest 6.378e-05 7.091e-05 7.091e-07      7.335e-07 -7.152e-05 6.190e-05</span></a>
<a class="sourceLine" id="cb8-110" data-line-number="110"><span class="co">#&gt; income_income 1.529e-04 2.713e-05 2.713e-07      2.774e-07  1.081e-04 1.497e-04</span></a>
<a class="sourceLine" id="cb8-111" data-line-number="111"><span class="co">#&gt; income_cons   6.897e-05 1.762e-05 1.762e-07      1.868e-07  3.912e-05 6.726e-05</span></a>
<a class="sourceLine" id="cb8-112" data-line-number="112"><span class="co">#&gt; cons_invest   1.383e-04 5.890e-05 5.890e-07      6.105e-07  3.342e-05 1.342e-04</span></a>
<a class="sourceLine" id="cb8-113" data-line-number="113"><span class="co">#&gt; cons_income   6.897e-05 1.762e-05 1.762e-07      1.868e-07  3.912e-05 6.726e-05</span></a>
<a class="sourceLine" id="cb8-114" data-line-number="114"><span class="co">#&gt; cons_cons     9.637e-05 1.758e-05 1.758e-07      1.903e-07  6.789e-05 9.434e-05</span></a>
<a class="sourceLine" id="cb8-115" data-line-number="115"><span class="co">#&gt;                   97.5%</span></a>
<a class="sourceLine" id="cb8-116" data-line-number="116"><span class="co">#&gt; invest_invest 0.0029372</span></a>
<a class="sourceLine" id="cb8-117" data-line-number="117"><span class="co">#&gt; invest_income 0.0002109</span></a>
<a class="sourceLine" id="cb8-118" data-line-number="118"><span class="co">#&gt; invest_cons   0.0002659</span></a>
<a class="sourceLine" id="cb8-119" data-line-number="119"><span class="co">#&gt; income_invest 0.0002109</span></a>
<a class="sourceLine" id="cb8-120" data-line-number="120"><span class="co">#&gt; income_income 0.0002144</span></a>
<a class="sourceLine" id="cb8-121" data-line-number="121"><span class="co">#&gt; income_cons   0.0001085</span></a>
<a class="sourceLine" id="cb8-122" data-line-number="122"><span class="co">#&gt; cons_invest   0.0002659</span></a>
<a class="sourceLine" id="cb8-123" data-line-number="123"><span class="co">#&gt; cons_income   0.0001085</span></a>
<a class="sourceLine" id="cb8-124" data-line-number="124"><span class="co">#&gt; cons_cons     0.0001354</span></a></code></pre></div>
<p>Forecasts, impulse responses and variance decompositions can be obtained in the usual manner.</p>
</div>
<div id="using-the-built-in-simulation-algorithm-of-bvartools" class="section level2">
<h2>Using the built-in simulation algorithm of <code>bvartools</code></h2>
<p>Priors can be added to object <code>data</code> using function <code>add_priors</code>. To use the same specification as above, argument <code>ssvs</code> is a named list, where element <code>inprior</code> contains the prior probability that a coefficient enters a model, element <code>semiautomatic</code> contains the factors used to obtain <span class="math inline">\(tau_0\)</span> and <span class="math inline">\(tau_1\)</span> based on the semiautomatic approach of George et al. (2008) and <code>exclude_det = TRUE</code> tells the algorithm to exclude deterministic terms from the SSVS algorithm.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Obtain priors</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">model_with_priors &lt;-<span class="st"> </span><span class="kw">add_priors</span>(data,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                                <span class="dt">ssvs =</span> <span class="kw">list</span>(<span class="dt">inprior =</span> <span class="fl">0.5</span>, <span class="dt">semiautomatic =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">10</span>), <span class="dt">exclude_det =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                                <span class="dt">sigma =</span> <span class="kw">list</span>(<span class="dt">df =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="fl">0.00001</span>))</a></code></pre></div>
<p>Posterior draws can be obtained using function <code>draw_posterior</code>. It will recognise the specifications of the model based on the content of object <code>model_with_priors</code> and produce the respective draws from the posterior.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">ssvs_est &lt;-<span class="st"> </span><span class="kw">draw_posterior</span>(model_with_priors)</a></code></pre></div>
<p>The output of <code>draw_posterior</code> is an object of class <code>bvar</code>. Thus, further analytical steps can be done as described above.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Chan, J., Koop, G., Poirier, D. J., &amp; Tobias, J. L. (2019). <em>Bayesian Econometric Methods</em> (2nd ed.). Cambridge: University Press.</p>
<p>George, E. I., Sun, D., &amp; Ni, S. (2008). Bayesian stochastic search for VAR model restrictions. <em>Journal of Econometrics, 142</em>(1), 553-580. <a href="https://doi.org/10.1016/j.jeconom.2007.08.017" class="uri">https://doi.org/10.1016/j.jeconom.2007.08.017</a></p>
<p>Koop, G., &amp; Korobilis, D. (2010). Bayesian multivariate time series methods for empirical macroeconomics. <em>Foundations and trends in econometrics, 3</em>(4), 267-358. <a href="https://dx.doi.org/10.1561/0800000013" class="uri">https://dx.doi.org/10.1561/0800000013</a></p>
<p>Korobilis, D. (2013). VAR forecasting using Bayesian variable selection. <em>Journal of Applied Econometrics, 28</em>(2), 204-230. <a href="https://doi.org/10.1002/jae.1271" class="uri">https://doi.org/10.1002/jae.1271</a></p>
<p>Lütkepohl, H. (2006). <em>New introduction to multiple time series analysis</em> (2nd ed.). Berlin: Springer.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>See Koop and Korobilis (2010) for an introduction to Bayesian VAR modelling and SSVS.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>This threshold value is usually set to 50 percent. 40 percent is chosen, because it yields similar results as the restricted model in Lütkepohl (2006, Section 5.2.10).<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
