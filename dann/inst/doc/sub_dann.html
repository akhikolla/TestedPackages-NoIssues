<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>SUB_DANN</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">SUB_DANN</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In general, dann will struggle as unrelated variables are intermingled with informative variables. To deal with this, sub_dann projects the data onto a unique subspace and then calls dann. sub_dann is able to mitigate the use of noise variables. See section 3 of <a href="https://web.stanford.edu/~hastie/Papers/dann_IEEE.pdf">Discriminate Adaptive Nearest Neighbor Classification</a> for details. Section 4 compares dann and sub_dann to a number of other approaches.</p>
</div>
<div id="arguments" class="section level1">
<h1>Arguments</h1>
<ul>
<li>k - The number of points in the neighborhood. Identical to k in standard k nearest neighbors. Same as dann function.</li>
<li>neighborhood_size - The number of data points used to estimate a good shape for the neighborhood. Same as dann function.</li>
<li>epsilon - Softening parameter. Usually has the least affect on performance. Same as dann function.</li>
<li>weighted - Should the individual between class covariance matrices be weighted? FALSE corresponds to original publication.</li>
<li>sphere - Type of covariance matrix to calculate.</li>
</ul>
</div>
<div id="example-circle-data-with-random-variables" class="section level1">
<h1>Example: Circle Data With Random Variables</h1>
<p>In the below example there are 2 related variables and 5 that are unrelated. Lets see how dann, sub_dann, and dann with only the correct features perform. First, lets make a data set to work with.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"> <span class="kw">library</span>(dann)</a>
<a class="sourceLine" id="cb1-2" title="2"> <span class="kw">library</span>(mlbench)</a>
<a class="sourceLine" id="cb1-3" title="3"> <span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-4" title="4"> <span class="kw">library</span>(dplyr, <span class="dt">warn.conflicts =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"> <span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"> <span class="co">######################</span></a>
<a class="sourceLine" id="cb1-8" title="8"> <span class="co"># Circle data with unrelated variables</span></a>
<a class="sourceLine" id="cb1-9" title="9"> <span class="co">######################</span></a>
<a class="sourceLine" id="cb1-10" title="10"> <span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-11" title="11"> train &lt;-<span class="st"> </span><span class="kw">mlbench.circle</span>(<span class="dv">500</span>, <span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="st">   </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb1-13" title="13"> <span class="kw">colnames</span>(train)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>, <span class="st">&quot;Y&quot;</span>)</a>
<a class="sourceLine" id="cb1-14" title="14"></a>
<a class="sourceLine" id="cb1-15" title="15"> <span class="co"># Add 5 unrelated variables</span></a>
<a class="sourceLine" id="cb1-16" title="16"> train &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="st">   </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb1-18" title="18">     <span class="dt">U1 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-19" title="19">     <span class="dt">U2 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-20" title="20">     <span class="dt">U3 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-21" title="21">     <span class="dt">U4 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-22" title="22">     <span class="dt">U5 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-23" title="23">   )</a>
<a class="sourceLine" id="cb1-24" title="24"> </a>
<a class="sourceLine" id="cb1-25" title="25"> test &lt;-<span class="st"> </span><span class="kw">mlbench.circle</span>(<span class="dv">500</span>, <span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="st">   </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb1-27" title="27"> <span class="kw">colnames</span>(test)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>, <span class="st">&quot;Y&quot;</span>)</a>
<a class="sourceLine" id="cb1-28" title="28"></a>
<a class="sourceLine" id="cb1-29" title="29"> <span class="co"># Add 5 unrelated variables</span></a>
<a class="sourceLine" id="cb1-30" title="30"> test &lt;-<span class="st"> </span>test <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="st">   </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb1-32" title="32">     <span class="dt">U1 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-33" title="33">     <span class="dt">U2 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-34" title="34">     <span class="dt">U3 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-35" title="35">     <span class="dt">U4 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-36" title="36">     <span class="dt">U5 =</span> <span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-37" title="37">   )</a></code></pre></div>
<p>To use with the dann package, data needs to be in matrices instead of dataframes.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"> xTrain &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">   </span><span class="kw">select</span>(X1, X2, U1, U2, U3, U4, U5) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="st">   </span><span class="kw">as.matrix</span>()</a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5"> yTrain &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="st">   </span><span class="kw">pull</span>(Y) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="st">   </span><span class="kw">as.numeric</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="st">   </span><span class="kw">as.vector</span>()</a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"> xTest &lt;-<span class="st"> </span>test <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="st">   </span><span class="kw">select</span>(X1, X2, U1, U2, U3, U4, U5) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="st">   </span><span class="kw">as.matrix</span>()</a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14"> yTest &lt;-<span class="st"> </span>test <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="st">   </span><span class="kw">pull</span>(Y) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="st">   </span><span class="kw">as.numeric</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="st">   </span><span class="kw">as.vector</span>()</a></code></pre></div>
<p>As expected, dann is not performant.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"> dannPreds &lt;-<span class="st"> </span><span class="kw">dann</span>(<span class="dt">xTrain =</span> xTrain, <span class="dt">yTrain =</span> yTrain, <span class="dt">xTest =</span> xTest, </a>
<a class="sourceLine" id="cb3-2" title="2">                   <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">neighborhood_size =</span> <span class="dv">50</span>, <span class="dt">epsilon =</span> <span class="dv">1</span>, <span class="dt">probability =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-3" title="3"> <span class="kw">mean</span>(dannPreds <span class="op">==</span><span class="st"> </span>yTest) <span class="co"># Not a good model</span></a></code></pre></div>
<pre><code>## [1] 0.668</code></pre>
<p>Moving on to sub_dann, the dimension of the subspace should be chosen based on the number of large eigenvalues. The graph suggests 2 is good (the correct answer).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"> <span class="kw">graph_eigenvalues</span>(<span class="dt">xTrain =</span> xTrain, <span class="dt">yTrain =</span> yTrain, </a>
<a class="sourceLine" id="cb5-2" title="2">                   <span class="dt">neighborhood_size =</span> <span class="dv">50</span>, <span class="dt">weighted =</span> <span class="ot">FALSE</span>, <span class="dt">sphere =</span> <span class="st">&quot;mcd&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>While continuing to use unrelated variables, sub_dann did much better than dann.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"> subDannPreds &lt;-<span class="st"> </span><span class="kw">sub_dann</span>(<span class="dt">xTrain =</span> xTrain, <span class="dt">yTrain =</span> yTrain, <span class="dt">xTest =</span> xTest, </a>
<a class="sourceLine" id="cb6-2" title="2">                          <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">neighborhood_size =</span> <span class="dv">50</span>, <span class="dt">epsilon =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb6-3" title="3">                          <span class="dt">probability =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb6-4" title="4">                          <span class="dt">weighted =</span> <span class="ot">FALSE</span>, <span class="dt">sphere =</span> <span class="st">&quot;mcd&quot;</span>, <span class="dt">numDim =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-5" title="5"> <span class="kw">mean</span>(subDannPreds <span class="op">==</span><span class="st"> </span>yTest) <span class="co"># sub_dan does much better when unrelated variables are present.</span></a></code></pre></div>
<pre><code>## [1] 0.882</code></pre>
<p>As an upper bound on performance for this A.I. approach, lets try dann using only the informative variables. There is some improvement to be had.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"> variableSelectionDann &lt;-<span class="st"> </span><span class="kw">dann</span>(<span class="dt">xTrain =</span> xTrain[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">yTrain =</span> yTrain, <span class="dt">xTest =</span> xTest[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb8-2" title="2">                               <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">neighborhood_size =</span> <span class="dv">50</span>, <span class="dt">epsilon =</span> <span class="dv">1</span>, <span class="dt">probability =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-3" title="3"> </a>
<a class="sourceLine" id="cb8-4" title="4"> <span class="kw">mean</span>(variableSelectionDann <span class="op">==</span><span class="st"> </span>yTest) <span class="co"># Best model found when only true predictors are used.</span></a></code></pre></div>
<pre><code>## [1] 0.944</code></pre>
<p>Overall, dann with the correct variables did better than sub_dann. But in practice, it is usually unknown which variables are informative. The best course of action is to find the best set of variables. But due to project timelines, this is not always an option. subb_dann is an way to gain some level of performance with minimal work.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
